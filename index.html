import React, { useState } from 'react';
import { 
  Download, 
  Plus, 
  Trash2, 
  Youtube, 
  Twitter, 
  Instagram, 
  Facebook, 
  Github, 
  Linkedin, 
  Globe 
} from 'lucide-react';

const ModernProfileHub = () => {
  const [profile, setProfile] = useState({
    name: '',
    profilePicture: '',
    supportLink: '',
    email: '',
    bio: '',
    theme: 'purple',
    socials: []
  });

  const themes = {
    purple: {
      gradient: 'bg-[conic-gradient(at_top,_var(--tw-gradient-stops))] from-purple-600 via-pink-600 to-blue-600',
      button: 'bg-gradient-to-r from-purple-500 to-pink-500',
      accent: 'text-purple-500'
    },
    blue: {
      gradient: 'bg-[conic-gradient(at_top,_var(--tw-gradient-stops))] from-sky-500 via-blue-600 to-cyan-500',
      button: 'bg-gradient-to-r from-blue-500 to-cyan-500',
      accent: 'text-blue-500'
    },
    green: {
      gradient: 'bg-[conic-gradient(at_top,_var(--tw-gradient-stops))] from-emerald-500 via-teal-600 to-green-500',
      button: 'bg-gradient-to-r from-green-500 to-emerald-500',
      accent: 'text-green-500'
    }
  };

  const platforms = {
    Youtube: { icon: Youtube, color: 'text-red-500' },
    Twitter: { icon: Twitter, color: 'text-blue-400' },
    Instagram: { icon: Instagram, color: 'text-pink-500' },
    Facebook: { icon: Facebook, color: 'text-blue-600' },
    Github: { icon: Github, color: 'text-gray-800' },
    LinkedIn: { icon: Linkedin, color: 'text-blue-700' },
    Website: { icon: Globe, color: 'text-gray-600' }
  };

  const handleProfileChange = (e) => {
    const { name, value } = e.target;
    setProfile(prev => ({
      ...prev,
      [name]: value
    }));
  };

  const addSocialProfile = () => {
    setProfile(prev => ({
      ...prev,
      socials: [...prev.socials, { platform: '', url: '', customLabel: '' }]
    }));
  };

  const removeSocialProfile = (index) => {
    setProfile(prev => ({
      ...prev,
      socials: prev.socials.filter((_, i) => i !== index)
    }));
  };

  const updateSocialProfile = (index, field, value) => {
    const newSocials = [...profile.socials];
    newSocials[index] = {
      ...newSocials[index],
      [field]: value
    };
    setProfile(prev => ({
      ...prev,
      socials: newSocials
    }));
  };

  const generateHTML = () => {
    // Download logic remains the same
    const blob = new Blob([template], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'modern-profile.html';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  };

  return (
    <div className="max-w-6xl mx-auto p-6">
      <div className="grid lg:grid-cols-2 gap-8">
        {/* Editor Panel */}
        <div className="bg-white rounded-2xl shadow-xl p-8 space-y-8">
          <h2 className="text-2xl font-bold">Design Your Profile</h2>
          
          {/* Theme Selection */}
          <div className="space-y-4">
            <label className="block text-sm font-medium text-gray-700">Choose Theme</label>
            <div className="grid grid-cols-3 gap-4">
              {Object.entries(themes).map(([name, theme]) => (
                <button
                  key={name}
                  onClick={() => setProfile(prev => ({ ...prev, theme: name }))}
                  className={`h-12 rounded-xl transition-all ${theme.gradient} ${
                    profile.theme === name ? 'ring-2 ring-offset-2 ring-blue-500' : ''
                  }`}
                />
              ))}
            </div>
          </div>

          {/* Profile Information */}
          <div className="space-y-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Name</label>
              <input
                type="text"
                name="name"
                value={profile.name}
                onChange={handleProfileChange}
                className="w-full p-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500"
                placeholder="Your Name"
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Bio</label>
              <textarea
                name="bio"
                value={profile.bio}
                onChange={handleProfileChange}
                className="w-full p-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500"
                placeholder="A brief description about you"
                rows="3"
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Profile Picture URL</label>
              <input
                type="url"
                name="profilePicture"
                value={profile.profilePicture}
                onChange={handleProfileChange}
                className="w-full p-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500"
                placeholder="https://your-image-url.com"
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
              <input
                type="email"
                name="email"
                value={profile.email}
                onChange={handleProfileChange}
                className="w-full p-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500"
                placeholder="your@email.com"
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Support Link</label>
              <input
                type="url"
                name="supportLink"
                value={profile.supportLink}
                onChange={handleProfileChange}
                className="w-full p-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500"
                placeholder="Your support/donation link"
              />
            </div>
          </div>

          {/* Social Links */}
          <div className="space-y-4">
            <div className="flex items-center justify-between">
              <h3 className="text-lg font-semibold">Social Links</h3>
              <button
                onClick={addSocialProfile}
                className={`flex items-center gap-2 px-4 py-2 rounded-lg text-white ${themes[profile.theme].button}`}
              >
                <Plus size={16} /> Add Link
              </button>
            </div>

            {profile.socials.map((social, index) => (
              <div key={index} className="p-4 bg-gray-50 rounded-xl space-y-3">
                <div className="flex gap-2">
                  <select
                    value={social.platform}
                    onChange={(e) => updateSocialProfile(index, 'platform', e.target.value)}
                    className="flex-1 p-3 rounded-lg border border-gray-200"
                  >
                    <option value="">Select Platform</option>
                    {Object.keys(platforms).map(platform => (
                      <option key={platform} value={platform}>{platform}</option>
                    ))}
                  </select>
                  <button
                    onClick={() => removeSocialProfile(index)}
                    className="p-3 text-red-500 hover:bg-red-50 rounded-lg"
                  >
                    <Trash2 size={20} />
                  </button>
                </div>
                <input
                  type="url"
                  value={social.url}
                  onChange={(e) => updateSocialProfile(index, 'url', e.target.value)}
                  className="w-full p-3 rounded-lg border border-gray-200"
                  placeholder="Profile URL"
                />
                <input
                  type="text"
                  value={social.customLabel}
                  onChange={(e) => updateSocialProfile(index, 'customLabel', e.target.value)}
                  className="w-full p-3 rounded-lg border border-gray-200"
                  placeholder="Custom Label (optional)"
                />
              </div>
            ))}
          </div>

          <button
            onClick={generateHTML}
            className={`flex items-center justify-center gap-2 w-full p-4 rounded-xl text-white ${themes[profile.theme].button}`}
          >
            <Download size={20} /> Download HTML
          </button>
        </div>

        {/* Preview Panel */}
        <div className={`${themes[profile.theme].gradient} rounded-2xl p-8 min-h-[600px] relative overflow-hidden`}>
          <div className="bg-white/10 backdrop-blur-md rounded-2xl shadow-xl overflow-hidden">
            <div className="p-8 text-center text-white">
              {profile.profilePicture && (
                <img
                  src={profile.profilePicture}
                  alt={profile.name}
                  className="w-32 h-32 rounded-full mx-auto mb-6 border-4 border-white/20 object-cover shadow-lg"
                />
              )}
              <h1 className="text-3xl font-bold mb-3">{profile.name || 'Your Name'}</h1>
              {profile.bio && <p className="text-white/80 mb-6">{profile.bio}</p>}
              {profile.supportLink && (
                <a 
                  href={profile.supportLink}
                  className="inline-block px-6 py-2 rounded-full bg-white/10 hover:bg-white/20 transition-all"
                >
                  Support Me ❤️
                </a>
              )}
            </div>

            <div className="p-8 space-y-4">
              {profile.socials.map((social, index) => {
                const platform = platforms[social.platform];
                const Icon = platform?.icon;
                return (
                  <a
                    key={index}
                    href={social.url}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="flex items-center justify-center gap-3 w-full p-4 bg-white/10 hover:bg-white/20 rounded-xl text-white transition-all"
                  >
                    {Icon && <Icon size={20} />}
                    {social.customLabel || social.platform || 'Platform Name'}
                  </a>
                );
              })}
            </div>

            {profile.email && (
              <div className="pb-8 text-center">
                <a href={`mailto:${profile.email}`} className="text-white/60 hover:text-white">
                  {profile.email}
                </a>
              </div>
            )}
          </div>
          
          {/* Animated background elements */}
          <div className="absolute inset-0 -z-10">
            <div className="absolute top-10 left-10 w-32 h-32 bg-white/10 rounded-full blur-3xl animate-pulse" />
            <div className="absolute bottom-10 right-10 w-32 h-32 bg-white/10 rounded-full blur-3xl animate-pulse delay-1000" />
          </div>
        </div>
      </div>
    </div>
  );
};

export default ModernProfileHub;
